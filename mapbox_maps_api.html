<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Second Mapbox Map</title>
    <!-- Mapbox CSS -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <!-- Custom CSS -->
    <style>
        #map {
            /* the width and height may be set to any size */
            width: 100%;
            height: 700px;
        }
    </style>
</head>
<body>

<h1>My Second Mapbox Map!</h1>

<!-- The HTML element that serves as the Mapbox container -->
<div id='map'></div>

<!-- Mapbox JS -->

<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="js/keys.js"></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script>
    mapboxgl.accessToken = mapBoxToken;
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/navigation-preview-night-v2',
        zoom: 10,
    });
    geocode( "Waring, TX, 78074", mapBoxToken)
        .then(function (result) {
            map.setCenter(result);
        });

    var restaurants = [
        {
            name: "Alamo Springs Cafe",
            address: '107 Alamo Rd, Fredericksburg, TX 78624',
            menu: 'http://places.singleplatform.com/alamo-springs-cafe/menu?ref=google',
            phone: '(830) 990-8004'
        },
        {
            name: 'Broken Stone Pizza Co.',
            address: '1022 N Main St, Boerne, TX 78006',
            menu: 'https://www.brokenstonepizzaco.com/boerne-menu',
            phone: '(830) 331-9020'

        },
        {
            name: "Mague's Cafe",
            address: '934 N Main St, Boerne, TX 78006',
            menu: 'https://www.boernemenu.com/magues-cafe',
            phone: '(830) 249-9168'
        }
    ];
     restaurants.forEach(function (restaurant){
         geocode( restaurant.address, mapBoxToken)
             .then(function (result) {
                 var markerOptions = {
                     color: "limegreen"
                 };
                 var popup = new mapboxgl.Popup({offset: 25})
                     .setHTML("<h2>"+restaurant.name+"</h2>"  + "<br>" + restaurant.address + "<br>" +"<a href='"+ restaurant.menu+"' target='_blank'>" + restaurant.menu + "</a>"+ "<br>" + restaurant.phone);

                 new mapboxgl.Marker(markerOptions)
                     .setLngLat(result)
                     .addTo(map)
                     .setPopup(popup);
             })
    });



</script>
<!-- Custom JS -->

</body>
</html>
